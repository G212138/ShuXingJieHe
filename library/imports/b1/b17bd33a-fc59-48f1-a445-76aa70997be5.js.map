{"version":3,"sources":["assets\\game\\scripts\\SkeletonExt.js"],"names":["cc","game","once","EVENT_ENGINE_INITED","js","mixin","sp","Skeleton","prototype","update","dt","CC_EDITOR","engine","_animatingInEditMode","animatingInEditMode","paused","timeScale","isAnimationCached","_isAniComplete","_animationQueue","length","_headAniInfo","frameCache","_frameCache","isInvalid","updateToFrame","frames","_curFrame","shift","_accTime","delay","aniInfo","setAnimation","animationName","loop","_updateCache","_updateRealtime"],"mappings":";;;;;;AACAA,EAAE,CAACC,IAAH,CAAQC,IAAR,CAAaF,EAAE,CAACC,IAAH,CAAQE,mBAArB,EAA0C,YAAY;EAElDH,EAAE,CAACI,EAAH,CAAMC,KAAN,CAAYC,EAAE,CAACC,QAAH,CAAYC,SAAxB,EAAmC;IAC/BC,MAD+B,kBACvBC,EADuB,EACnB;MACR;MAEA,IAAIC,SAAJ,EAAe;QACXX,EAAE,CAACY,MAAH,CAAUC,oBAAV,GAAiC,CAAjC;QACAb,EAAE,CAACY,MAAH,CAAUE,mBAAV,GAAgC,CAAhC;MACH;;MAED,IAAI,KAAKC,MAAT,EAAiB;MAEjBL,EAAE,IAAI,KAAKM,SAAL,GAAiBV,EAAE,CAACU,SAA1B;;MAEA,IAAI,KAAKC,iBAAL,EAAJ,EAA8B;QAE1B;QACA,IAAI,KAAKC,cAAT,EAAyB;UACrB,IAAI,KAAKC,eAAL,CAAqBC,MAArB,KAAgC,CAAhC,IAAqC,CAAC,KAAKC,YAA/C,EAA6D;YACzD,IAAIC,UAAU,GAAG,KAAKC,WAAtB;;YACA,IAAID,UAAU,IAAIA,UAAU,CAACE,SAAX,EAAlB,EAA0C;cACtCF,UAAU,CAACG,aAAX;cACA,IAAIC,MAAM,GAAGJ,UAAU,CAACI,MAAxB;cACA,KAAKC,SAAL,GAAiBD,MAAM,CAACA,MAAM,CAACN,MAAP,GAAgB,CAAjB,CAAvB;YACH;;YACD;UACH;;UACD,IAAI,CAAC,KAAKC,YAAV,EAAwB;YACpB,KAAKA,YAAL,GAAoB,KAAKF,eAAL,CAAqBS,KAArB,EAApB;UACH;;UACD,KAAKC,QAAL,IAAiBnB,EAAjB;;UACA,IAAI,KAAKmB,QAAL,GAAgB,KAAKR,YAAL,CAAkBS,KAAtC,EAA6C;YACzC,IAAIC,OAAO,GAAG,KAAKV,YAAnB;YACA,KAAKA,YAAL,GAAoB,IAApB;YACA,KAAKW,YAAL,CAAmB,CAAnB,EAAsBD,OAAO,CAACE,aAA9B,EAA6CF,OAAO,CAACG,IAArD;UACH;;UACD;QACH;;QAED,KAAKC,YAAL,CAAkBzB,EAAlB;MACH,CA1BD,MA0BO;QACH,KAAK0B,eAAL,CAAqB1B,EAArB;MACH;IACJ;EA1C8B,CAAnC;AA6CH,CA/CD","sourceRoot":"/","sourcesContent":["\ncc.game.once(cc.game.EVENT_ENGINE_INITED, function () {\n\n    cc.js.mixin(sp.Skeleton.prototype, {\n        update (dt) {\n            // if (CC_EDITOR) return;\n            \n            if (CC_EDITOR) {\n                cc.engine._animatingInEditMode = 1;\n                cc.engine.animatingInEditMode = 1;\n            }\n\n            if (this.paused) return;\n    \n            dt *= this.timeScale * sp.timeScale;\n    \n            if (this.isAnimationCached()) {\n    \n                // Cache mode and has animation queue.\n                if (this._isAniComplete) {\n                    if (this._animationQueue.length === 0 && !this._headAniInfo) {\n                        let frameCache = this._frameCache;\n                        if (frameCache && frameCache.isInvalid()) {\n                            frameCache.updateToFrame();\n                            let frames = frameCache.frames;\n                            this._curFrame = frames[frames.length - 1];\n                        }\n                        return;\n                    }\n                    if (!this._headAniInfo) {\n                        this._headAniInfo = this._animationQueue.shift();\n                    }\n                    this._accTime += dt;\n                    if (this._accTime > this._headAniInfo.delay) {\n                        let aniInfo = this._headAniInfo;\n                        this._headAniInfo = null;\n                        this.setAnimation (0, aniInfo.animationName, aniInfo.loop);\n                    }\n                    return;\n                }\n    \n                this._updateCache(dt);\n            } else {\n                this._updateRealtime(dt);\n            }\n        }\n    })\n\n})\n"]}